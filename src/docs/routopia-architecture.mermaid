graph TB
    subgraph Client Layer
        Web[Web Application]
        Mobile[Mobile Apps]
        API[API Gateway]
    end

    subgraph Service Layer
        Auth[Auth Service]
        Route[Route Service]
        Activity[Activity Service]
        User[User Service]
        AI[AI Service]
        Analytics[Analytics Service]
    end

    subgraph Data Layer
        DB[(PostgreSQL)]
        Cache[(Redis Cache)]
        Search[(Elasticsearch)]
        Queue[(Message Queue)]
    end

    subgraph External Services
        Maps[Map Providers]
        Weather[Weather APIs]
        Places[Places APIs]
        GPT[OpenAI GPT]
    end

    Web --> API
    Mobile --> API
    API --> Auth
    API --> Route
    API --> Activity
    API --> User
    API --> AI
    API --> Analytics

    Route --> Maps
    Route --> Weather
    Route --> Places
    AI --> GPT

    Route --> DB
    Activity --> DB
    User --> DB
    Analytics --> DB

    Route --> Cache
    Activity --> Cache
    User --> Cache

    Route --> Search
    Activity --> Search

    Route --> Queue
    Activity --> Queue
    Analytics --> Queue

    classDef primary fill:#e1f5fe,stroke:#01579b
    classDef service fill:#f3e5f5,stroke:#4a148c
    classDef data fill:#f1f8e9,stroke:#33691e
    classDef external fill:#fff3e0,stroke:#e65100

    class Web,Mobile,API primary
    class Auth,Route,Activity,User,AI,Analytics service
    class DB,Cache,Search,Queue data
    class Maps,Weather,Places,GPT external
